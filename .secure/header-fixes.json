{
  "Strict-Transport-Security": {
    "title": "HTTP Strict Transport Security (HSTS) Missing",
    "severity": "HIGH",
    "summary": "Browsers cannot be instructed to only connect over HTTPS, leaving room for SSL stripping and downgrade attacks.",
    "why_it_matters": "Attackers performing man-in-the-middle attacks can force clients onto HTTP and intercept authentication cookies or inject content.",
    "fix_steps": [
      "Add the Strict-Transport-Security header with a max-age of at least 31536000 seconds (1 year).",
      "Include the preload directive once the site passes the HSTS preload requirements and submit to hstspreload.org.",
      "Enable HTTPS redirects at the load balancer or web server so all traffic reaches TLS before the header is evaluated."
    ],
    "server_snippets": {
      "nginx": "add_header Strict-Transport-Security \"max-age=63072000; includeSubDomains; preload\" always;",
      "apache": "Header always set Strict-Transport-Security \"max-age=63072000; includeSubDomains; preload\""
    },
    "code_snippets": {
      "html": "<meta http-equiv=\"Strict-Transport-Security\" content=\"max-age=63072000; includeSubDomains; preload\">",
      "php": "<?php\nheader('Strict-Transport-Security: max-age=63072000; includeSubDomains; preload');\nheader('Location: https://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'], true, 301);\nexit;\n?>",
      "javascript": "// Express example using helmet\nconst helmet = require('helmet');\nconst express = require('express');\nconst app = express();\n\napp.use(helmet.hsts({\n  maxAge: 63072000,\n  includeSubDomains: true,\n  preload: true\n}));",
      "react": "import { Helmet } from 'react-helmet';\n\nexport function HstsMeta() {\n  return (\n    <Helmet>\n      <meta httpEquiv=\"Strict-Transport-Security\" content=\"max-age=63072000; includeSubDomains; preload\" />\n    </Helmet>\n  );\n}"
    },
    "verification": [
      "Run curl -I https://domain and confirm Strict-Transport-Security is present with the expected directives.",
      "Use securityheaders.com or Observatory by Mozilla to ensure an A grade for HSTS."
    ],
    "references": [
      {"label": "OWASP HSTS Cheat Sheet", "url": "https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html"}
    ]
  },
  "Content-Security-Policy": {
    "title": "Content Security Policy Not Configured",
    "severity": "HIGH",
    "summary": "Without CSP, injected scripts or mixed content can execute freely in visitors' browsers.",
    "why_it_matters": "CSP mitigates XSS and data exfiltration by restricting where scripts, images, and frames can load from.",
    "fix_steps": [
      "Start with a report-only CSP to monitor violations before enforcing.",
      "Define default-src 'self'; and explicitly allow only required domains for script-src, img-src, font-src, etc.",
      "Use nonces or hashes for inline scripts and remove unsafe-inline or unsafe-eval where possible."
    ],
    "server_snippets": {
      "nginx": "add_header Content-Security-Policy \"default-src 'self'; script-src 'self' https://www.gstatic.com; object-src 'none'; frame-ancestors 'none'\" always;",
      "apache": "Header set Content-Security-Policy \"default-src 'self'; script-src 'self' https://www.gstatic.com; object-src 'none'; frame-ancestors 'none'\""
    },
    "code_snippets": {
      "html": "<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self' https://www.gstatic.com; object-src 'none'; frame-ancestors 'none'\">",
      "php": "<?php\n$csp = \"default-src 'self'; script-src 'self' https://www.gstatic.com; object-src 'none'; frame-ancestors 'none'\";\nheader(\"Content-Security-Policy: {$csp}\");\n?>",
      "javascript": "// Express middleware example\nconst csp = \"default-src 'self'; script-src 'self' https://www.gstatic.com; object-src 'none'; frame-ancestors 'none'\";\napp.use((req, res, next) => {\n  res.setHeader('Content-Security-Policy', csp);\n  next();\n});",
      "react": "import { Helmet } from 'react-helmet';\n\nexport function CspMeta() {\n  return (\n    <Helmet>\n      <meta\n        httpEquiv=\"Content-Security-Policy\"\n        content=\"default-src 'self'; script-src 'self' https://www.gstatic.com; object-src 'none'; frame-ancestors 'none'\"\n      />\n    </Helmet>\n  );\n}"
    },
    "verification": [
      "Load the site in Chrome DevTools > Security tab and confirm CSP appears with no violations.",
      "Review CSP violation reports (if report-uri/report-to configured) to ensure only expected origins are listed."
    ],
    "references": [
      {"label": "MDN CSP Guide", "url": "https://developer.mozilla.org/docs/Web/HTTP/CSP"}
    ]
  },
  "X-Content-Type-Options": {
    "title": "X-Content-Type-Options Missing",
    "severity": "MEDIUM",
    "summary": "Browsers may MIME-sniff file types and execute malicious payloads served with incorrect Content-Type headers.",
    "why_it_matters": "Attackers can upload or reflect files that browsers treat as executable even if marked as text/plain.",
    "fix_steps": [
      "Add X-Content-Type-Options: nosniff to every HTTP response.",
      "Ensure the application sets accurate Content-Type headers for downloads and API responses.",
      "Block user-uploaded files from being served directly without sanitizing or storing on separate domain."
    ],
    "server_snippets": {
      "nginx": "add_header X-Content-Type-Options \"nosniff\" always;",
      "apache": "Header set X-Content-Type-Options \"nosniff\""
    },
    "code_snippets": {
      "html": "<meta http-equiv=\"X-Content-Type-Options\" content=\"nosniff\">",
      "php": "<?php\nheader('X-Content-Type-Options: nosniff');\n?>",
      "javascript": "app.use((req, res, next) => {\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n  next();\n});",
      "react": "import { Helmet } from 'react-helmet';\n\nexport function NosniffMeta() {\n  return (\n    <Helmet>\n      <meta httpEquiv=\"X-Content-Type-Options\" content=\"nosniff\" />\n    </Helmet>\n  );\n}"
    },
    "verification": [
      "curl -I https://domain | grep X-Content-Type-Options should show 'nosniff'.",
      "Use securityheaders.com scorecard to confirm header is detected."
    ],
    "references": [
      {"label": "MDN X-Content-Type-Options", "url": "https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Content-Type-Options"}
    ]
  },
  "X-Frame-Options": {
    "title": "X-Frame-Options Missing",
    "severity": "MEDIUM",
    "summary": "Clickjacking attacks can embed your site in hidden iframes and trick users into executing actions.",
    "why_it_matters": "Sensitive workflows (checkout, admin panels) can be hijacked through transparent overlays when XFO is absent.",
    "fix_steps": [
      "Set X-Frame-Options to SAMEORIGIN if the site only needs to load itself in frames.",
      "Use DENY for maximum protection when no framing is required.",
      "If legitimate framing is needed, configure Content-Security-Policy frame-ancestors to a precise allowlist instead of ALLOW-FROM wildcards."
    ],
    "server_snippets": {
      "nginx": "add_header X-Frame-Options \"SAMEORIGIN\" always;",
      "apache": "Header always set X-Frame-Options \"SAMEORIGIN\""
    },
    "code_snippets": {
      "html": "<meta http-equiv=\"X-Frame-Options\" content=\"SAMEORIGIN\">",
      "php": "<?php\nheader('X-Frame-Options: SAMEORIGIN');\n?>",
      "javascript": "app.use((req, res, next) => {\n  res.setHeader('X-Frame-Options', 'SAMEORIGIN');\n  next();\n});",
      "react": "import { Helmet } from 'react-helmet';\n\nexport function FrameGuardMeta() {\n  return (\n    <Helmet>\n      <meta httpEquiv=\"X-Frame-Options\" content=\"SAMEORIGIN\" />\n    </Helmet>\n  );\n}"
    },
    "verification": [
      "Visit https://clickjacker.io, input your URL, and ensure framing attempts fail.",
      "Inspect response headers in browser dev tools for X-Frame-Options."
    ],
    "references": [
      {"label": "OWASP Clickjacking Defense", "url": "https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html"}
    ]
  },
  "X-XSS-Protection": {
    "title": "Legacy X-XSS-Protection Disabled",
    "severity": "LOW",
    "summary": "Although modern browsers rely on CSP, legacy clients benefit from opt-in XSS filters via X-XSS-Protection.",
    "why_it_matters": "Older WebKit/Trident browsers might not block reflective XSS payloads unless this header is enabled.",
    "fix_steps": [
      "Set X-XSS-Protection: 1; mode=block to instruct supportive browsers to halt rendering when XSS is detected.",
      "Prefer CSP for modern defenses but keep this header for backwards compatibility.",
      "Audit application code to remove inline scripts and adopt framework output encoding."
    ],
    "server_snippets": {
      "nginx": "add_header X-XSS-Protection \"1; mode=block\" always;",
      "apache": "Header set X-XSS-Protection \"1; mode=block\""
    },
    "code_snippets": {
      "html": "<meta http-equiv=\"X-XSS-Protection\" content=\"1; mode=block\">",
      "php": "<?php\nheader('X-XSS-Protection: 1; mode=block');\n?>",
      "javascript": "app.use((req, res, next) => {\n  res.setHeader('X-XSS-Protection', '1; mode=block');\n  next();\n});",
      "react": "import { Helmet } from 'react-helmet';\n\nexport function LegacyXssMeta() {\n  return (\n    <Helmet>\n      <meta httpEquiv=\"X-XSS-Protection\" content=\"1; mode=block\" />\n    </Helmet>\n  );\n}"
    },
    "verification": [
      "Use an older Edge/IE VM to confirm reflective payloads are blocked and browser console logs enforcement.",
      "Securityheaders.com should report X-XSS-Protection as present."
    ],
    "references": [
      {"label": "MDN X-XSS-Protection", "url": "https://developer.mozilla.org/docs/Web/HTTP/Headers/X-XSS-Protection"}
    ]
  },
  "Permissions-Policy": {
    "title": "Permissions Policy Not Defined",
    "severity": "MEDIUM",
    "summary": "Without Permissions-Policy, every embedded frame can access features like camera, microphone, or geolocation by default.",
    "why_it_matters": "Restricting powerful features prevents malicious third-party content from abusing device sensors.",
    "fix_steps": [
      "Determine which features (camera, geolocation, fullscreen, payment) the site actually requires.",
      "Set Permissions-Policy (formerly Feature-Policy) to '()' for features not needed, and 'self' or specific origins for those allowed.",
      "Review embedded third-party widgets and explicitly grant minimal privileges."
    ],
    "server_snippets": {
      "nginx": "add_header Permissions-Policy \"camera=(), microphone=(), geolocation=('self')\" always;",
      "apache": "Header set Permissions-Policy \"camera=(), microphone=(), geolocation=('self')\""
    },
    "code_snippets": {
      "html": "<meta http-equiv=\"Permissions-Policy\" content=\"camera=(), microphone=(), geolocation=('self')\">",
      "php": "<?php\nheader(\"Permissions-Policy: camera=(), microphone=(), geolocation=('self')\");\n?>",
      "javascript": "const policy = \"camera=(), microphone=(), geolocation=('self')\";\napp.use((req, res, next) => {\n  res.setHeader('Permissions-Policy', policy);\n  next();\n});",
      "react": "import { Helmet } from 'react-helmet';\n\nexport function PermissionsMeta() {\n  return (\n    <Helmet>\n      <meta httpEquiv=\"Permissions-Policy\" content=\"camera=(), microphone=(), geolocation('self')\" />\n    </Helmet>\n  );\n}"
    },
    "verification": [
      "Open Chrome DevTools > Application > Permissions Policy to confirm directives load as expected.",
      "Use Observatory by Mozilla to ensure the header is parsed correctly."
    ],
    "references": [
      {"label": "MDN Permissions Policy", "url": "https://developer.mozilla.org/docs/Web/HTTP/Permissions_Policy"}
    ]
  },
  "Referrer-Policy": {
    "title": "Referrer Policy Missing",
    "severity": "LOW",
    "summary": "Browsers may leak full URLs (including query params/tokens) when users follow outbound links.",
    "why_it_matters": "Sensitive identifiers in query strings can appear in third-party analytics, logs, or referer headers.",
    "fix_steps": [
      "Set Referrer-Policy to strict-origin-when-cross-origin for balanced privacy and analytics accuracy.",
      "Use no-referrer for applications passing access tokens or PII in query parameters.",
      "Verify marketing tooling continues to receive required attribution data after tightening policy."
    ],
    "server_snippets": {
      "nginx": "add_header Referrer-Policy \"strict-origin-when-cross-origin\" always;",
      "apache": "Header set Referrer-Policy \"strict-origin-when-cross-origin\""
    },
    "code_snippets": {
      "html": "<meta name=\"referrer\" content=\"strict-origin-when-cross-origin\">\n<meta http-equiv=\"Referrer-Policy\" content=\"strict-origin-when-cross-origin\">",
      "php": "<?php\nheader('Referrer-Policy: strict-origin-when-cross-origin');\n?>",
      "javascript": "app.use((req, res, next) => {\n  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');\n  next();\n});",
      "react": "import { Helmet } from 'react-helmet';\n\nexport function ReferrerMeta() {\n  return (\n    <Helmet>\n      <meta name=\"referrer\" content=\"strict-origin-when-cross-origin\" />\n      <meta httpEquiv=\"Referrer-Policy\" content=\"strict-origin-when-cross-origin\" />\n    </Helmet>\n  );\n}"
    },
    "verification": [
      "Use Chrome DevTools Network panel to inspect request headers and ensure Referer aligns with policy.",
      "Run curl -I and confirm Referrer-Policy header is returned."
    ],
    "references": [
      {"label": "MDN Referrer Policy", "url": "https://developer.mozilla.org/docs/Web/HTTP/Headers/Referrer-Policy"}
    ]
  },
  "Server": {
    "title": "Server Header Disclosure",
    "severity": "LOW",
    "summary": "Server response header exposes software version and configuration details that aid attackers.",
    "why_it_matters": "Revealing exact server versions (Apache/2.4.52, nginx/1.20.1) allows attackers to search for known vulnerabilities and reduces reconnaissance effort.",
    "fix_steps": [
      "Configure web server to suppress or minimize the Server header.",
      "Use ServerTokens Prod in Apache or server_tokens off in nginx.",
      "Consider using reverse proxies/WAFs to rewrite or strip server headers."
    ],
    "server_snippets": {
      "nginx": "server_tokens off;",
      "apache": "ServerTokens Prod\nServerSignature Off"
    },
    "code_snippets": {
      "php": "<?php\nheader_remove('Server');\n?>",
      "javascript": "// Express example with helmet\nconst helmet = require('helmet');\napp.use(helmet.hidePoweredBy());\napp.use((req, res, next) => {\n  res.removeHeader('Server');\n  next();\n});"
    },
    "verification": [
      "Run curl -I https://domain and confirm Server header is absent or shows minimal info.",
      "Use securityheaders.com to verify server header disclosure is resolved."
    ],
    "references": [
      {"label": "Claranet 2024 Research", "url": "https://www.claranet.com/us/blog/2025-01-07-claranet%E2%80%99s-top-10-web-application-vulnerabilities-found-2024"}
    ]
  },
  "Cookie-Security": {
    "title": "Missing Cookie Security Attributes",
    "severity": "MEDIUM",
    "summary": "Authentication cookies lack Secure, HttpOnly, or SameSite attributes, increasing XSS/CSRF risk.",
    "why_it_matters": "Without Secure, cookies leak over HTTP; without HttpOnly, JavaScript can steal them; without SameSite, CSRF attacks succeed.",
    "fix_steps": [
      "Set Secure flag on all cookies for HTTPS sites.",
      "Enable HttpOnly to prevent client-side script access.",
      "Configure SameSite=Strict or Lax based on cross-origin needs."
    ],
    "server_snippets": {
      "nginx": "proxy_cookie_path / \"/; Secure; HttpOnly; SameSite=Strict\";",
      "apache": "Header edit Set-Cookie \"(?i)^(.*; )?secure$\" \"$1Secure\""
    },
    "code_snippets": {
      "php": "<?php\nsession_set_cookie_params([\n  'lifetime' => 0,\n  'path' => '/',\n  'domain' => $_SERVER['HTTP_HOST'],\n  'secure' => true,\n  'httponly' => true,\n  'samesite' => 'Strict'\n]);\n?>",
      "javascript": "// Express with cookie-parser\napp.use(session({\n  cookie: {\n    secure: true,\n    httpOnly: true,\n    sameSite: 'strict'\n  }\n}));",
      "react": "// Client-side cannot set security attributesâ€”must be done server-side\n// Use HttpOnly cookies and avoid localStorage for auth tokens"
    },
    "verification": [
      "Inspect cookies in browser DevTools > Application > Cookies and confirm Secure/HttpOnly/SameSite flags.",
      "Use OWASP ZAP or Burp to verify cookie attributes in responses."
    ],
    "references": [
      {"label": "Claranet Cookie Attributes 2024", "url": "https://www.claranet.com/us/blog/2025-01-07-claranet%E2%80%99s-top-10-web-application-vulnerabilities-found-2024"}
    ]
  },
  "CSP-Report-URI-Deprecated": {
    "title": "CSP Uses Deprecated report-uri Directive",
    "severity": "LOW",
    "summary": "Content Security Policy uses the deprecated report-uri instead of the modern report-to mechanism.",
    "why_it_matters": "Modern browsers may stop supporting report-uri; violation reports could be lost, reducing security monitoring.",
    "fix_steps": [
      "Replace report-uri with report-to directive in CSP headers.",
      "Add Reporting-Endpoints header to define endpoint groups.",
      "Keep report-uri temporarily for backward compatibility if needed."
    ],
    "server_snippets": {
      "nginx": "add_header Reporting-Endpoints \"default-endpoint=\"https://reports.example.com/default\"\";\nadd_header Content-Security-Policy \"default-src 'self'; report-to default-endpoint\";",
      "apache": "Header set Reporting-Endpoints \"default-endpoint=\"https://reports.example.com/default\"\"\nHeader set Content-Security-Policy \"default-src 'self'; report-to default-endpoint\""
    },
    "code_snippets": {
      "javascript": "// Express example\napp.use((req, res, next) => {\n  res.setHeader('Reporting-Endpoints', 'default-endpoint=\"https://reports.example.com/default\"');\n  res.setHeader('Content-Security-Policy', 'default-src \"self\"; report-to default-endpoint');\n  next();\n});",
      "react": "import { Helmet } from 'react-helmet';\n\nexport function ModernCspReports() {\n  return (\n    <Helmet>\n      <meta httpEquiv=\"Reporting-Endpoints\" content=\"default-endpoint=&quot;https://reports.example.com/default&quot;\" />\n      <meta httpEquiv=\"Content-Security-Policy\" content=\"default-src 'self'; report-to default-endpoint\" />\n    </Helmet>\n  );\n}"
    },
    "verification": [
      "Check browser DevTools Console for CSP warnings about report-uri deprecation.",
      "Test violation reports by injecting a script and confirming delivery to the report-to endpoint."
    ],
    "references": [
      {"label": "MDN report-uri Deprecated", "url": "https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/report-uri"}
    ]
  },
  "React-Server-Components-RCE": {
    "title": "React Server Components Remote Code Execution (CVE-2025-55182)",
    "severity": "CRITICAL",
    "summary": "Unauthenticated RCE in React Server Functions via malicious HTTP request deserialization.",
    "why_it_matters": "Attackers can execute arbitrary code on the server without authentication, leading to full system compromise.",
    "fix_steps": [
      "Update React to latest patched versions immediately (see React blog for version matrix).",
      "Update Next.js, React Router, Waku, and other affected frameworks to patched releases.",
      "If using canary releases, downgrade to latest stable patched versions.",
      "Audit for any exposed Server Function endpoints and implement additional authentication."
    ],
    "server_snippets": {
      "npm": "# Update to patched versions\nnpm install react@latest react-dom@latest\nnpm install next@15.4.10 # or appropriate version for your release line\nnpm install react-server-dom-webpack@latest"
    },
    "code_snippets": {
      "javascript": "// After updating, verify no unauthenticated Server Functions\n// Add authentication middleware to all Server Function routes\napp.use('/api/_rsc', (req, res, next) => {\n  if (!req.session?.userId) {\n    return res.status(401).end();\n  }\n  next();\n});"
    },
    "verification": [
      "Run npm audit to confirm no vulnerable React packages remain.",
      "Test with the public proof-of-concept to ensure the RCE is patched.",
      "Review access logs for suspicious /_rsc or Server Function requests."
    ],
    "references": [
      {"label": "React Critical RCE Advisory", "url": "https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components"},
      {"label": "CVE-2025-55182", "url": "https://www.cve.org/CVERecord?id=CVE-2025-55182"}
    ]
  }
}
